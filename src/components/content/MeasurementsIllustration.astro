---
import Warning from '../ui/Warning.astro';
---

<div class="measurements" data-shop-illustration>
    <div class="measurements__presentation" data-measurements-presentation>
        <div class="measurements__presentation__coords">
            <svg
                width="100%"
                height="100%"
                viewBox="0 0 529 729"
                focusable="false"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M93.256 728.96c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468Zm-.522-88.146a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098H92.5c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm-2.07-90v-11.7l1.026 1.062H88v-1.962h5.004v12.6h-2.34Zm10.095.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM90.664 458.6v-11.7l1.026 1.062H88V446h5.004v12.6h-2.34Zm9.016.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042L96.53 446h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm-11.194-90v-1.566l5.004-4.752c.42-.396.732-.744.936-1.044.204-.3.336-.576.396-.828.072-.264.108-.51.108-.738 0-.576-.198-1.02-.594-1.332-.396-.324-.978-.486-1.746-.486-.612 0-1.17.108-1.674.324a3.385 3.385 0 0 0-1.278.99L88 358.088c.492-.66 1.152-1.17 1.98-1.53.84-.372 1.776-.558 2.808-.558.912 0 1.704.15 2.376.45.684.288 1.206.702 1.566 1.242.372.54.558 1.182.558 1.926 0 .408-.054.816-.162 1.224-.108.396-.312.816-.612 1.26-.3.444-.738.942-1.314 1.494l-4.302 4.086-.486-.882h7.362v1.98h-9.288Zm15.895.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM88.486 278.78v-1.566l5.004-4.752c.42-.396.732-.744.936-1.044.204-.3.336-.576.396-.828.072-.264.108-.51.108-.738 0-.576-.198-1.02-.594-1.332-.396-.324-.978-.486-1.746-.486-.612 0-1.17.108-1.674.324a3.385 3.385 0 0 0-1.278.99L88 268.088c.492-.66 1.152-1.17 1.98-1.53.84-.372 1.776-.558 2.808-.558.912 0 1.704.15 2.376.45.684.288 1.206.702 1.566 1.242.372.54.558 1.182.558 1.926 0 .408-.054.816-.162 1.224-.108.396-.312.816-.612 1.26-.3.444-.738.942-1.314 1.494l-4.302 4.086-.486-.882h7.362v1.98h-9.288Zm14.814.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm-10.566-90a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l1.008-1.818c.456.372 1.008.672 1.656.9a6.083 6.083 0 0 0 2.034.342c.84 0 1.494-.168 1.962-.504.468-.348.702-.816.702-1.404 0-.576-.216-1.032-.648-1.368-.432-.336-1.128-.504-2.088-.504h-1.152v-1.602l3.6-4.284.306.882h-6.768v-1.962h8.586v1.566l-3.6 4.284-1.224-.72h.702c1.548 0 2.706.348 3.474 1.044.78.684 1.17 1.566 1.17 2.646 0 .708-.18 1.362-.54 1.962-.36.6-.912 1.086-1.656 1.458-.732.36-1.662.54-2.79.54Zm11.773 0c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM92.734 99.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l1.008-1.818c.456.372 1.008.672 1.656.9a6.083 6.083 0 0 0 2.034.342c.84 0 1.494-.168 1.962-.504.468-.348.702-.816.702-1.404 0-.576-.216-1.032-.648-1.368-.432-.336-1.128-.504-2.088-.504h-1.152v-1.602l3.6-4.284.306.882h-6.768V86.4h8.586v1.566l-3.6 4.284-1.224-.72h.702c1.548 0 2.706.348 3.474 1.044.78.684 1.17 1.566 1.17 2.646 0 .708-.18 1.362-.54 1.962-.36.6-.912 1.086-1.656 1.458-.732.36-1.662.54-2.79.54Zm10.517 0a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Z"
                    fill="currentColor"></path>
                <path
                    d="M5.925 78.626c-1.008 0-1.908-.21-2.7-.63a4.806 4.806 0 0 1-1.836-1.764c-.444-.744-.666-1.59-.666-2.538 0-.96.222-1.806.666-2.538a4.676 4.676 0 0 1 1.836-1.746c.792-.42 1.692-.63 2.7-.63.936 0 1.758.192 2.466.576.72.372 1.266.924 1.638 1.656L8.301 72.02c-.288-.456-.642-.792-1.062-1.008a2.803 2.803 0 0 0-1.332-.324c-.552 0-1.05.12-1.494.36-.444.24-.792.588-1.044 1.044-.252.444-.378.978-.378 1.602 0 .624.126 1.164.378 1.62.252.444.6.786 1.044 1.026.444.24.942.36 1.494.36.48 0 .924-.108 1.332-.324.42-.216.774-.552 1.062-1.008l1.728 1.008a3.936 3.936 0 0 1-1.638 1.674c-.708.384-1.53.576-2.466.576Zm6.085-.126v-9.612h2.358l3.87 6.822h-.936l4.068-6.822h2.106l.018 9.612H21.46v-7.2l.36.234-3.6 5.958h-.972l-3.618-6.12.432-.108V78.5H12.01Zm208.915-67.874c-1.008 0-1.908-.21-2.7-.63a4.806 4.806 0 0 1-1.836-1.764c-.444-.744-.666-1.59-.666-2.538 0-.96.222-1.806.666-2.538a4.676 4.676 0 0 1 1.836-1.746c.792-.42 1.692-.63 2.7-.63.936 0 1.758.192 2.466.576.72.372 1.266.924 1.638 1.656l-1.728 1.008c-.288-.456-.642-.792-1.062-1.008a2.803 2.803 0 0 0-1.332-.324c-.552 0-1.05.12-1.494.36-.444.24-.792.588-1.044 1.044-.252.444-.378.978-.378 1.602 0 .624.126 1.164.378 1.62.252.444.6.786 1.044 1.026.444.24.942.36 1.494.36.48 0 .924-.108 1.332-.324.42-.216.774-.552 1.062-1.008l1.728 1.008a3.936 3.936 0 0 1-1.638 1.674c-.708.384-1.53.576-2.466.576Zm6.085-.126V.888h2.358l3.87 6.822h-.936L236.37.888h2.106l.018 9.612h-2.034V3.3l.36.234-3.6 5.958h-.972l-3.618-6.12.432-.108V10.5h-2.052Z"
                    fill="var(--color-gray)"></path>
                <path
                    d="M1.207 93h72m-72 8.918h18m-18 8.914h36M1 129.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36m-36 8.918h18M1 219.5h36m-35.793 8.918h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36M1 309.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36M1 399.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36M1 489.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36M1 579.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72m-72 8.918h18m-18 8.914h36M1 669.5h36m-35.793-9.75h18m-18 18.668h18m-18 8.918h36m-36 8.914h18m-18 8.918h36m-36 8.914h18m-18 8.918h72"
                    stroke="var(--color-product-primego)"
                    stroke-width="2"
                    stroke-linecap="round"></path>
                <path
                    d="M252.199 102.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468Zm89.72 2.034a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm84.913-.18V90.3l1.026 1.062h-3.69V89.4h5.004V102h-2.34Zm10.095.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM514.215 102V90.3l1.026 1.062h-3.69V89.4h5.004V102h-2.34Zm9.015.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Z"
                    fill="currentColor"></path>
                <path
                    d="M522.207 2v72m-3.6-72v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v72m-3.6-72v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v72m-3.6-72v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v36m-3.6-36v18m-3.6-18v18m-3.6-18v18m-3.6-18v18m-3.6-18v72"
                    stroke="var(--color-product-primego)"
                    stroke-width="2"
                    stroke-linecap="round"></path>
            </svg>
        </div>
        <div class="measurements__preview">
            <div class="measurements__preview__shoe-sole" data-shoe-sole>
                <svg
                    preserveAspectRatio="none"
                    width="100%"
                    height="100%"
                    viewBox="0 0 231 546"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="4" y="1" width="218" height="543">
                        <path
                            d="M217.165 166.612c16.963-94.784-10.44-196.108-111.534-156.194-135.44 53.476-104.1 235.811-79.456 449.073 8.703 75.316 71.562 105.931 113.267 66.827 30.331-28.438 39.809-66.827 44.075-198.098 1.169-36 18.829-78.805 33.648-161.608Z"
                            fill="currentColor"
                            fill-opacity=".46"></path>
                    </mask>
                    <g mask="url(#a)" fill="currentColor" fill-opacity=".4">
                        <path
                            d="M217.165 166.612c16.963-94.784-10.44-196.108-111.534-156.194-135.44 53.476-104.1 235.811-79.456 449.073 8.703 75.316 71.562 105.931 113.267 66.827 30.331-28.438 39.809-66.827 44.075-198.098 1.169-36 18.829-78.805 33.648-161.608Z"
                        ></path>
                        <path
                            opacity=".15"
                            d="M181.157 326.176c0-3.966 1.081-7.331 3.245-10.095 2.163-2.765 5.709-4.207 10.636-4.327h25.059v14.422h-25.059v33.171l20.552-7.932 4.507 12.619-25.059 9.735v37.138h25.059v13.521h-38.94v-98.252Zm-67.253 0c0-3.966 1.082-7.331 3.245-10.095 2.164-2.765 5.709-4.207 10.637-4.327h15.684l2.884 4.146 2.704-4.146h14.964c4.927.12 8.473 1.562 10.636 4.327 2.163 2.764 3.245 6.129 3.245 10.095v98.252h-13.881v-98.252h-11.178v98.252h-13.881v-98.252h-11.177v98.252h-13.882v-98.252Zm-17.076 98.252V311.754h13.881v112.674H96.828ZM54.575 311.754h25.058c4.928.12 8.473 1.562 10.637 4.327 2.163 2.764 3.245 6.129 3.245 10.095v19.831c0 3.966-.24 7.932-.721 11.898-.36 3.846-2.043 6.67-5.048 8.473l-5.408 2.163 11.177 55.887H79.633l-11.177-54.985v54.985H54.575V311.754Zm13.881 14.422v33.171l11.177-4.326v-28.845H68.456Zm-42.252 0v33.171l11.177-4.326v-28.845H26.204Zm11.177-14.422c4.928.12 8.473 1.562 10.636 4.327 2.164 2.764 3.245 6.129 3.245 10.095v19.831c0 3.966-.24 7.932-.72 11.898-.361 3.846-2.044 6.67-5.049 8.473l-19.29 7.391v50.659h-13.88V311.754H37.38Zm123.071 134.875c0-3.966 1.081-7.331 3.245-10.095 2.163-2.765 5.708-4.207 10.636-4.327h11.177c4.928.12 8.473 1.562 10.637 4.327 2.163 2.764 3.245 6.129 3.245 10.095v84.731c0 5.288-.421 8.894-1.262 10.817-.842 1.802-2.284 2.704-4.327 2.704H166.04c-2.043 0-3.485-.902-4.326-2.704-.842-1.923-1.262-5.529-1.262-10.817v-84.731Zm13.881 84.731h11.177v-84.731h-11.177v84.731Zm-31.076-99.153c4.928.12 8.473 1.562 10.637 4.327 2.163 2.764 3.245 6.129 3.245 10.095v13.701h-13.882v-13.701H132.08v84.731h11.177v-40.923l-5.769 1.803v-14.964l19.651-6.129v60.213c0 5.288-.421 8.894-1.262 10.817-.842 1.802-2.284 2.704-4.327 2.704h-33.352V432.207h25.059Zm-67.311 14.422c0-3.966 1.082-7.331 3.245-10.095 2.164-2.765 5.71-4.207 10.637-4.327h25.058v14.422H89.828V479.8l20.551-7.932 4.507 12.62-25.058 9.735v37.137h25.058v13.521h-38.94v-98.252Zm-67.252 0c0-3.966 1.082-7.331 3.245-10.095 2.163-2.765 5.709-4.207 10.636-4.327H38.26l2.885 4.146 2.704-4.146h14.963c4.928.12 8.473 1.562 10.637 4.327 2.163 2.764 3.245 6.129 3.245 10.095v98.252H58.81v-98.252H47.634v98.252H33.752v-98.252H22.575v98.252H8.694v-98.252Zm-17.077 98.252V432.207H5.5v112.674H-8.383Zm229.497-339.49c0-3.966 1.081-7.331 3.245-10.096 2.163-2.764 5.708-4.206 10.636-4.326h11.177c4.928.12 8.473 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v84.731c0 5.288-.421 8.893-1.262 10.816-.842 1.803-2.284 2.704-4.327 2.704h-27.763c-2.043 0-3.485-.901-4.327-2.704-.841-1.923-1.261-5.528-1.261-10.816v-84.731Zm13.881 84.731h11.177v-84.731h-11.177v84.731Zm-31.076-99.153c4.928.12 8.473 1.562 10.636 4.326 2.164 2.765 3.245 6.13 3.245 10.096v13.701h-13.881v-13.701h-11.177v84.731h11.177v-40.923l-5.769 1.802v-14.963l19.65-6.129v60.213c0 5.288-.42 8.893-1.262 10.816-.841 1.803-2.283 2.704-4.326 2.704H178.86V190.969h25.059Zm-67.311 14.422c0-3.966 1.082-7.331 3.245-10.096 2.163-2.764 5.709-4.206 10.637-4.326h25.058v14.422H150.49v33.171l20.551-7.932 4.507 12.619-25.058 9.735v37.138h25.058v13.52h-38.94v-98.251Zm-67.252 0c0-3.966 1.081-7.331 3.245-10.096 2.163-2.764 5.709-4.206 10.636-4.326h15.684l2.885 4.146 2.704-4.146h14.963c4.928.12 8.473 1.562 10.636 4.326 2.164 2.765 3.245 6.13 3.245 10.096v98.251h-13.881v-98.251h-11.177v98.251H94.414v-98.251H83.237v98.251H69.356v-98.251ZM52.28 303.642V190.969h13.88v112.673H52.28ZM10.026 190.969h25.059c4.927.12 8.473 1.562 10.636 4.326 2.164 2.765 3.245 6.13 3.245 10.096v19.831c0 3.966-.24 7.932-.721 11.898-.36 3.846-2.043 6.67-5.048 8.473l-5.408 2.163 11.177 55.886H35.085l-11.178-54.984v54.984h-13.88V190.969Zm13.881 14.422v33.171l11.178-4.327v-28.844H23.907Zm-42.252 0v33.171l11.177-4.327v-28.844h-11.177Zm11.177-14.422c4.928.12 8.473 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v19.831c0 3.966-.24 7.932-.721 11.898-.361 3.846-2.044 6.67-5.048 8.473l-19.29 7.391v50.658h-13.881V190.969h25.058Zm194.96-106.41c0-3.966 1.081-7.331 3.245-10.096 2.163-2.764 5.708-4.206 10.636-4.326h25.059v14.422h-25.059v33.171l20.552-7.932 4.507 12.619-25.059 9.735v37.138h25.059v13.52h-38.94V84.559Zm-67.253 0c0-3.966 1.082-7.331 3.245-10.096 2.163-2.764 5.709-4.206 10.636-4.326h15.685l2.884 4.146 2.704-4.146h14.963c4.928.12 8.473 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v98.251h-13.882V84.559h-11.177v98.251h-13.881V84.559H134.42v98.251h-13.881V84.559Zm-17.077 98.251V70.137h13.882V182.81h-13.882ZM61.21 70.137h25.058c4.928.12 8.473 1.562 10.636 4.326 2.164 2.765 3.245 6.13 3.245 10.096v19.831c0 3.966-.24 7.932-.72 11.898-.361 3.846-2.044 6.67-5.048 8.473l-5.409 2.163 11.177 55.886h-13.88L75.09 127.826v54.984H61.21V70.137Zm13.88 14.422v33.171l11.178-4.327V84.559H75.091Zm-42.252 0v33.171l11.178-4.327V84.559H32.838Zm11.178-14.422c4.927.12 8.473 1.562 10.636 4.326 2.163 2.765 3.245 6.13 3.245 10.096v19.831c0 3.966-.24 7.932-.721 11.898-.36 3.846-2.043 6.67-5.048 8.473l-19.29 7.391v50.658H18.957V70.137h25.059ZM232.648-51.191c4.928.12 8.474 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v13.7h-13.882v-13.7h-11.177v84.73h11.177V7.038l-5.768 1.803V-6.122l19.65-6.13v60.213c0 5.289-.421 8.894-1.262 10.817-.841 1.803-2.284 2.704-4.327 2.704H207.59V-51.19h25.058Zm-67.31 14.421c0-3.965 1.081-7.33 3.245-10.095 2.163-2.764 5.708-4.206 10.636-4.326h25.059v14.422h-25.059V-3.6l20.552-7.931 4.507 12.62-25.059 9.734V47.96h25.059v13.521h-38.94V-36.77Zm-67.253 0c0-3.965 1.082-7.33 3.245-10.095 2.164-2.764 5.709-4.206 10.637-4.326h15.684l2.884 4.146 2.704-4.146h14.963c4.928.12 8.474 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v98.251h-13.882v-98.251h-11.177v98.251h-13.881v-98.251h-11.177v98.251H98.085v-98.251ZM81.008 61.482V-51.19H94.89V61.482H81.008ZM38.756-51.191h25.058c4.928.12 8.473 1.562 10.637 4.326 2.163 2.765 3.245 6.13 3.245 10.096v19.83c0 3.966-.24 7.933-.721 11.899-.361 3.846-2.044 6.67-5.048 8.473l-5.409 2.163 11.178 55.886H63.814L52.637 6.498v54.984H38.756V-51.19ZM52.637-36.77V-3.6l11.177-4.326V-36.77H52.637Zm-42.252 0v33.172l11.177-4.327v-28.844H10.385Zm11.177-14.42c4.927.12 8.473 1.562 10.636 4.326 2.163 2.765 3.245 6.13 3.245 10.096v19.83a98.8 98.8 0 0 1-.72 11.899c-.361 3.846-2.044 6.67-5.049 8.473l-19.29 7.391v50.658h-13.88V-51.19h25.058Z"
                        ></path>
                    </g>
                </svg>
            </div>
            <div class="measurements__preview__foot" data-foot-container>
                <div class="measurement__tooltip" data-y-ruler-tooltip>
                    <span></span>
                    <svg
                        class="measurement__tooltip__arrow"
                        focusable="false"
                        aria-hidden="true"
                        width="12"
                        height="6"
                        viewBox="0 0 12 16"
                    >
                        <path stroke="none" d="M0,0 H12 L6,6 Q6,6 6,6 Z"></path>
                    </svg>
                </div>
                <div class="measurement__tooltip" data-x-ruler-tooltip>
                    <span></span>
                    <svg
                        class="measurement__tooltip__arrow"
                        focusable="false"
                        aria-hidden="true"
                        width="12"
                        height="6"
                        viewBox="0 0 12 16"
                    >
                        <path stroke="none" d="M0,0 H12 L6,6 Q6,6 6,6 Z"></path>
                    </svg>
                </div>
                <svg
                    preserveAspectRatio="none"
                    width="100%"
                    height="100%"
                    focusable="false"
                    viewBox="0 0 197 540"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M137.335 103.236c-2.051-5.063-4.102-10.127-5.967-14.996-.559.195-1.119.195-1.492.39v13.243c10.257 7.596 19.021 20.06 35.432 16.165v2.531c-2.611.585-5.594 1.948-7.832 1.364-6.527-2.143-13.427-4.285-19.022-7.985-9.324-6.232-18.835-11.685-29.651-13.243-4.289-.585-9.51-.39-12.867 1.752-13.986 8.959-27.6 18.502-40.654 28.629-8.951 6.817-16.597 15.386-25.175 22.786-1.865 1.558-6.154 2.143-7.832.974-3.357-2.532-.933-5.648 1.491-7.985 6.527-6.232 13.24-12.269 19.395-18.696 1.305-1.363 2.424-4.285 2.051-6.038-1.492-6.232-3.357-12.464-5.967-18.112-1.492-2.921-4.662-5.842-7.833-6.816-4.475-1.558-8.205.974-10.63 5.453-6.153 11.685-6.34 24.734-6.9 37.588-.186 3.7 0 7.595 0 11.49-.559.195-1.305.195-1.864.39-.746-3.701-1.679-7.206-2.051-10.907-1.492-11.685-1.12-23.175 2.61-34.276 3.357-9.543 8.02-17.139 19.954-15.775 2.052-15.386 4.476-30.187 24.616-29.019 2.424-16.359 7.646-30.186 26.667-30.381 2.798-11.49 5.968-14.607 16.038-15.775 16.224-1.948 16.784-1.558 21.446 7.595 2.611-5.063 4.662-12.27 9.138-16.359 4.848-4.285 12.121-7.206 18.461-7.206 13.8-.39 25.176 5.843 31.703 19.476 4.475 9.348 8.205 19.28 12.494 28.628 6.714 14.607 3.171 29.213 1.119 44.21-1.119 8.568-1.492 17.527-.186 26.096 3.916 29.018 2.424 57.063-6.341 85.107-8.019 25.708-15.664 51.61-20.7 77.902-4.102 21.423-4.848 43.43-5.967 65.242-2.238 45.378-7.273 90.171-18.648 134.185-5.222 19.865-13.8 37.977-31.516 49.078-24.99 15.775-63.965 16.944-80.002-25.707-2.238-5.843-4.662-11.686-5.595-17.723-4.475-27.655-8.951-54.726-11.375-81.991-3.73-44.599-5.781-89.587-8.765-134.185-1.305-23.565-3.357-47.131-5.035-70.501-.187-2.142 0-4.284 0-7.011 2.424 27.071 5.035 53.557 7.086 80.044 3.544 48.883 5.968 97.766 10.443 146.454 2.238 24.539 7.087 48.688 12.495 72.643 2.424 10.322 8.019 20.449 14.36 28.824 12.867 16.748 38.415 19.67 59.488 8.374 13.613-7.401 22.378-19.281 28.345-33.498 8.392-19.67 11.003-40.703 14.733-61.542 6.9-38.561 7.832-77.706 9.883-116.657 1.865-36.419 9.884-71.669 21.633-105.946 7.272-21.617 13.24-43.43 11.562-66.605-.746-11.296-3.357-22.592-3.357-33.887 0-11.88 1.865-23.955 3.543-35.64 1.305-9.154-.186-17.528-3.73-25.708-3.916-8.958-7.646-18.112-11.748-26.876-7.646-17.138-27.6-22.591-41.027-11.685-1.865 1.558-3.916 4.09-4.475 6.622-1.865 10.322-3.171 20.644-4.662 31.16-1.865 12.66 1.305 24.15 7.086 35.25 2.238 4.285 3.916 8.96 5.408 13.633.746 1.558.186 3.701.186 5.453Zm-40.653-11.1c9.324 1.752 18.648 3.505 27.973 5.063 2.424-13.048 2.051-13.048-2.238-25.123-2.052-5.648-3.73-12.27-2.984-18.112 1.305-10.517-1.678-19.865-5.035-29.408-.56-1.558-2.797-3.7-4.289-3.506-4.849 0-9.884.39-14.546 1.753-5.408 1.558-7.087 7.985-4.29 13.049 8.766 15.385 13.428 31.55 6.528 49.467-.746 2.142-.746 4.674-1.12 6.816-.186-2.142-.745-4.674-.745-7.01.186-5.064 1.865-10.323.932-15.191-1.492-8.764-4.662-17.333-6.9-25.903-1.492-5.647-5.035-6.816-9.883-6.232-8.02.974-12.681 5.843-15.292 13.828-2.424 7.4-4.103 14.411 4.103 19.67 1.864 1.168 3.17 3.31 4.848 4.869 4.29 4.479 5.035 9.348 2.238 15.19-2.051 4.285-3.357 8.959-5.035 13.438.373.39.746.779 1.305.974 8.206-4.674 16.411-9.153 24.43-13.633Zm-49.046 31.939c4.476-3.506 8.02-7.206 12.308-9.153 6.714-3.116 8.392-8.375 10.63-14.996 4.103-12.075 1.865-20.45-8.205-27.85-6.154-4.48-12.681-5.843-17.716-1.169-4.849 4.48-8.02 19.086-5.595 23.76 2.61 5.064 4.662 10.712 6.34 16.165 1.306 3.895 1.492 8.179 2.238 13.243Z"
                        fill="currentColor"></path>
                </svg>
            </div>
        </div>
    </div>
    <div class="recommended-size">
        Ваш рекомендованный размер: <span class="recommended-size__content" data-recommended-size>-</span>
    </div>
    <div data-size-warning>
        <Warning class="warning"> Внимание! Выбранный размер не совпадает с рекомендованным</Warning>
    </div>
</div>

<style lang="scss">
    .measurements {
        padding: calc(var(--15px) * 5) var(--90px) var(--90px) var(--120px);

        &__presentation {
            position: relative;
            container-type: size;
            margin: calc(var(--1mm) * 15) auto;
            aspect-ratio: 529 / 729;
            width: 75%;

            // не работает в safari на iphone c iOS 15 и некоторых других браузерах
            // https://caniuse.com/mdn-css_types_length_container_query_length_units
            --100cqh: 100cqh;
            --container-height-in-mm: 400;
            // фолбэк для старых браузеров, --height сетиться из js
            --container-height: var(--100cqh, var(--height));
            --1mm: calc(var(--container-height) / var(--container-height-in-mm));

            &__coords {
                width: 100%;
                height: 100%;
                color: var(--color-white);
            }
        }
    }

    .measurements__preview {
        position: absolute;
        bottom: 0;
        right: 0;
        width: calc(var(--1mm) * (150 + 3)); // ruler's longer than 150mm because of labels
        height: calc(var(--1mm) * 350);
        display: flex;
        align-items: end;
    }

    .measurements__preview__shoe-sole {
        display: none;
        position: absolute;
        bottom: 0;
        left: 0;
        width: calc(var(--1mm) * var(--width));
        height: calc(var(--1mm) * var(--length));
        color: var(--color-product-primego);
        transition:
            height 0.2s,
            width 0.2s;

        & > svg {
            height: 100%;
        }

        &.fit {
            color: #98f91c;
        }
    }

    .measurements__preview__foot {
        position: relative;
        width: calc(var(--1mm) * var(--width, 84));
        height: calc(var(--1mm) * var(--length, 280));
        transition:
            height 0.2s,
            width 0.2s;

        & > svg {
            height: 100%;
        }

        &::before {
            content: '';
            position: absolute;
            top: 0;
            left: calc(var(--1mm) * -60);
            width: calc(var(--1mm) * 210);
            height: var(--2px);
            background-image: repeating-linear-gradient(
                90deg,
                var(--color-gray) 0 var(--15px),
                transparent var(--15px) var(--30px)
            );
        }

        &::after {
            content: '';
            position: absolute;
            right: 0;
            bottom: 0;
            height: calc(var(--1mm) * 330);
            width: var(--2px);
            background-image: repeating-linear-gradient(
                0deg,
                var(--color-gray) 0 var(--15px),
                transparent var(--15px) var(--30px)
            );
        }
    }

    .measurement__tooltip {
        position: absolute;
        background-color: var(--color-bg-disabled);
        padding: var(--8px) var(--15px);
        font-size: var(--text-font-size);
        border-radius: var(--4px);
        font-weight: 600;

        &__arrow {
            fill: var(--color-bg-disabled);
            position: absolute;
            pointer-events: none;
        }

        &[data-x-ruler-tooltip] {
            bottom: var(--container-height);
            right: 0;
            margin-bottom: calc(var(--1mm) * 10);
            transform: translateX(50%);

            .measurement__tooltip__arrow {
                transform: translateX(-50%) translateY(100%);
                width: var(--30px);
                bottom: 0;
                left: 50%;
            }
        }

        &[data-y-ruler-tooltip] {
            top: 0;
            left: calc(var(--1mm) * -150);
            transform: translateX(-100%) translateY(-50%);

            .measurement__tooltip__arrow {
                top: 50%;
                left: calc(100% + 0px);
                width: var(--30px);
                transform: rotate(-90deg) translateX(25%) translateY(-50%);
            }
        }
    }

    .recommended-size {
        width: 100%;
        border-radius: var(--4px);
        padding: var(--15px);
        background-color: var(--color-bg-disabled);
        font-weight: 600;
        font-size: var(--text-font-size);
        display: flex;
        align-items: center;
        justify-content: center;

        &__content {
            margin-left: var(--8px);
        }
    }

    .warning {
        background-color: var(--color-bg-disabled);
    }

    [data-shop-illustration='hidden'] {
        display: none;
    }

    [data-size-warning] {
        display: none;
    }
</style>

<script>
    import { listenKeys } from 'nanostores';
    import { $selectedProduct, $selectedOrOnlyRecommendedSize } from '../../stores/fittingProductStore';

    function toCm(valueInMm: number | undefined) {
        if (!valueInMm) return undefined;
        return valueInMm / 10;
    }

    function setContainerHeightForOldBrowsers() {
        const container = document.querySelector<HTMLDivElement>('[data-measurements-presentation]');
        container?.style.setProperty('--height', `${container.offsetHeight}px`);
    }

    document.addEventListener('DOMContentLoaded', () => {
        setContainerHeightForOldBrowsers();

        const xTooltip = document.querySelector('[data-x-ruler-tooltip]');
        const xTooltipContent = xTooltip?.querySelector('span');

        const yTooltip = document.querySelector('[data-y-ruler-tooltip]');
        const yTooltipContent = yTooltip?.querySelector('span');

        const footContainer = document.querySelector<HTMLDivElement>('[data-foot-container]');

        $selectedProduct.listen((product) => {
            const width = product.width;
            const length = product.length;
            footContainer?.style.setProperty('--length', length ? length.toString() : null);
            footContainer?.style.setProperty('--width', width ? width.toString() : null);
            if (width) {
                xTooltip.style.display = 'block';
                xTooltipContent.textContent = `${toCm(width)?.toFixed(1)}`;
            } else {
                xTooltip.style.display = 'none';
            }
            if (length) {
                yTooltip.style.display = 'block';
                yTooltipContent.textContent = `${toCm(length)?.toFixed(1)}`;
            } else {
                yTooltip.style.display = 'none';
            }
        });

        const shoeSole = document.querySelector<HTMLDivElement>('[data-shoe-sole]');
        $selectedOrOnlyRecommendedSize.listen((params) => {
            if (params) {
                const { size, isFit } = params;
                shoeSole?.style.setProperty('--length', size.length ? size.length.toString() : null);
                shoeSole?.style.setProperty('--width', size.width ? size.width.toString() : null);
                if (isFit) {
                    shoeSole?.classList.add('fit');
                } else {
                    shoeSole?.classList.remove('fit');
                }
                shoeSole.style.display = 'block';
            } else {
                shoeSole.style.display = 'none';
            }
        });

        const recommendedSize = document.querySelector('[data-recommended-size]');
        const warningElement = document.querySelector<HTMLDivElement>('[data-size-warning]');
        listenKeys($selectedProduct, ['recommended', 'size'], ({ recommended, size }) => {
            recommendedSize.textContent = recommended ?? '-';
            const isNotSame = recommended && size && recommended !== size;
            warningElement.style.display = isNotSame ? 'block' : 'none';
        });
    });
</script>
