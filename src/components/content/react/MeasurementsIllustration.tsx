import React, { useEffect, useRef, useState } from 'react';
import { useStore } from '@nanostores/react';
import { $selectedOrOnlyRecommendedSize, $selectedProduct } from '../../../stores/fittingProductStore.ts';
import styles from './MeasurementsIllustration.module.scss';
import cn from 'classnames';
import { useTranslations } from '../../../i18n/utils';

const lang = document.documentElement.lang as 'en' | 'ru';
const t = useTranslations(lang);

interface Props {
    sku: string;
    showOn?: 'mobile' | 'desktop';
    withoutSole?: boolean;
    className?: string;
    warning?: any;
}
function MeasurementsIllustration({ showOn, withoutSole, className, warning, sku }: Props) {
    const store = useStore($selectedProduct);
    const selectedOrOnlyRecommended = useStore($selectedOrOnlyRecommendedSize);
    const containerRef = useRef<HTMLDivElement>(null);
    const containerHeightForOldBrowsers = {
        '--height': `${containerRef.current?.offsetHeight}px`,
    } as React.CSSProperties;
    const isNotSame = store.recommended && store.size && store.recommended !== store.size;
    const isWarning = isNotSame && !store.selectedSizeApproval;
    const isMobile = useMobileMediaQuery();
    const visible = getVisible({ showOn, isMobile });
    if (!visible) return null;
    return (
        <div className={cn(styles.measurements, className)}>
            <div className={styles.measurements__presentation} ref={containerRef} style={containerHeightForOldBrowsers}>
                <div className={styles.measurements__presentation__coords}>
                    <svg
                        width="100%"
                        height="100%"
                        viewBox="0 0 450 792"
                        focusable="false"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M91.925 13.126c-1.008 0-1.908-.21-2.7-.63a4.806 4.806 0 0 1-1.836-1.764c-.444-.744-.666-1.59-.666-2.538 0-.96.222-1.806.666-2.538a4.676 4.676 0 0 1 1.836-1.746c.792-.42 1.692-.63 2.7-.63.936 0 1.758.192 2.466.576.72.372 1.266.924 1.638 1.656L94.301 6.52c-.288-.456-.642-.792-1.062-1.008a2.803 2.803 0 0 0-1.332-.324c-.552 0-1.05.12-1.494.36-.444.24-.792.588-1.044 1.044-.252.444-.378.978-.378 1.602 0 .624.126 1.164.378 1.62.252.444.6.786 1.044 1.026.444.24.942.36 1.494.36.48 0 .924-.108 1.332-.324.42-.216.774-.552 1.062-1.008l1.728 1.008a3.936 3.936 0 0 1-1.638 1.674c-.708.384-1.53.576-2.466.576ZM98.01 13V3.388h2.358l3.87 6.822h-.936l4.068-6.822h2.106l.018 9.612h-2.034V5.8l.36.234-3.6 5.958h-.972l-3.618-6.12.432-.108V13H98.01Zm332.915 687.126c-1.008 0-1.908-.21-2.7-.63a4.806 4.806 0 0 1-1.836-1.764c-.444-.744-.666-1.59-.666-2.538 0-.96.222-1.806.666-2.538a4.676 4.676 0 0 1 1.836-1.746c.792-.42 1.692-.63 2.7-.63.936 0 1.758.192 2.466.576.72.372 1.266.924 1.638 1.656l-1.728 1.008c-.288-.456-.642-.792-1.062-1.008a2.803 2.803 0 0 0-1.332-.324c-.552 0-1.05.12-1.494.36-.444.24-.792.588-1.044 1.044-.252.444-.378.978-.378 1.602 0 .624.126 1.164.378 1.62.252.444.6.786 1.044 1.026.444.24.942.36 1.494.36.48 0 .924-.108 1.332-.324.42-.216.774-.552 1.062-1.008l1.728 1.008a3.936 3.936 0 0 1-1.638 1.674c-.708.384-1.53.576-2.466.576Zm6.085-.126v-9.612h2.358l3.87 6.822h-.936l4.068-6.822h2.106l.018 9.612h-2.034v-7.2l.36.234-3.6 5.958h-.972l-3.618-6.12.432-.108V700h-2.052Z"
                            fill="var(--color-gray)"
                        ></path>
                        <path
                            d="M6.492 664.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468Zm-1.28-88.966a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234H1.414l.648-6.858H9.46v1.962H2.926l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558ZM2.825 483v-11.7l1.026 1.062H.16V470.4h5.004V483h-2.34Zm10.095.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM3.124 393v-11.7l1.026 1.062H.46V380.4h5.004V393h-2.34Zm9.016.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234H8.342l.648-6.858h7.398v1.962H9.854l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558ZM.836 303v-1.566l5.004-4.752c.42-.396.732-.744.936-1.044.204-.3.336-.576.396-.828.072-.264.108-.51.108-.738 0-.576-.198-1.02-.594-1.332-.396-.324-.978-.486-1.746-.486-.612 0-1.17.108-1.674.324a3.385 3.385 0 0 0-1.278.99l-1.638-1.26c.492-.66 1.152-1.17 1.98-1.53.84-.372 1.776-.558 2.808-.558.912 0 1.704.15 2.376.45.684.288 1.206.702 1.566 1.242.372.54.558 1.182.558 1.926 0 .408-.054.816-.162 1.224-.108.396-.312.816-.612 1.26-.3.444-.738.942-1.314 1.494l-4.302 4.086-.486-.882h7.362V303H.836Zm15.895.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM.636 213v-1.566l5.004-4.752c.42-.396.732-.744.936-1.044.204-.3.336-.576.396-.828.072-.264.108-.51.108-.738 0-.576-.198-1.02-.594-1.332-.396-.324-.978-.486-1.746-.486-.612 0-1.17.108-1.674.324a3.385 3.385 0 0 0-1.278.99l-1.638-1.26c.492-.66 1.152-1.17 1.98-1.53.84-.372 1.776-.558 2.808-.558.912 0 1.704.15 2.376.45.684.288 1.206.702 1.566 1.242.372.54.558 1.182.558 1.926 0 .408-.054.816-.162 1.224-.108.396-.312.816-.612 1.26-.3.444-.738.942-1.314 1.494l-4.302 4.086-.486-.882h7.362V213H.636Zm14.814.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm-10.492-90a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l1.008-1.818c.456.372 1.008.672 1.656.9a6.083 6.083 0 0 0 2.034.342c.84 0 1.494-.168 1.962-.504.468-.348.702-.816.702-1.404 0-.576-.216-1.032-.648-1.368-.432-.336-1.128-.504-2.088-.504H3.698v-1.602l3.6-4.284.306.882H.836V110.4h8.586v1.566l-3.6 4.284-1.224-.72H5.3c1.548 0 2.706.348 3.474 1.044.78.684 1.17 1.566 1.17 2.646 0 .708-.18 1.362-.54 1.962-.36.6-.912 1.086-1.656 1.458-.732.36-1.662.54-2.79.54Zm11.773 0c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM4.846 33.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l1.008-1.818c.456.372 1.008.672 1.656.9a6.083 6.083 0 0 0 2.034.342c.84 0 1.494-.168 1.962-.504.468-.348.702-.816.702-1.404 0-.576-.216-1.032-.648-1.368-.432-.336-1.128-.504-2.088-.504H3.586v-1.602l3.6-4.284.306.882H.724V20.4H9.31v1.566l-3.6 4.284-1.224-.72h.702c1.548 0 2.706.348 3.474 1.044.78.684 1.17 1.566 1.17 2.646 0 .708-.18 1.362-.54 1.962-.36.6-.912 1.086-1.656 1.458-.732.36-1.662.54-2.79.54Zm10.517 0a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.549-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.655.9a6.24 6.24 0 0 0 2.053.342c.827 0 1.475-.174 1.943-.522.48-.348.72-.816.72-1.404 0-.396-.101-.744-.305-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.397v1.962h-6.534l1.224-1.116-.486 5.13-1.223-1.098h2.538c1.248 0 2.25.168 3.005.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.655 1.476-.732.372-1.662.558-2.79.558Z"
                            fill="currentColor"
                        ></path>
                        <path
                            d="M111 27H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m72 0H39m72 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H75m36 9H93m18 9H39m375 34v72m-9-72v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v72m0-72v72m-9-72v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v72m0-72v72m-9-72v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v36m-9-36v18m-9-18v72"
                            stroke="var(--color-product-primego)"
                            strokeWidth="2"
                            strokeLinecap="round"
                        ></path>
                        <path
                            d="M143.048 791.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468Zm88.92 2.034a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Zm85.857-.18v-11.7l1.026 1.062h-3.69V778.4h5.004V791h-2.34Zm10.095.18c-.996 0-1.896-.252-2.7-.756-.792-.504-1.416-1.236-1.872-2.196-.456-.972-.684-2.148-.684-3.528s.228-2.55.684-3.51c.456-.972 1.08-1.71 1.872-2.214.804-.504 1.704-.756 2.7-.756 1.008 0 1.908.252 2.7.756.792.504 1.416 1.242 1.872 2.214.468.96.702 2.13.702 3.51s-.234 2.556-.702 3.528c-.456.96-1.08 1.692-1.872 2.196-.792.504-1.692.756-2.7.756Zm0-2.034c.588 0 1.098-.156 1.53-.468.432-.324.768-.816 1.008-1.476.252-.66.378-1.494.378-2.502 0-1.02-.126-1.854-.378-2.502-.24-.66-.576-1.146-1.008-1.458-.432-.324-.942-.486-1.53-.486a2.5 2.5 0 0 0-1.512.486c-.432.312-.774.798-1.026 1.458-.24.648-.36 1.482-.36 2.502 0 1.008.12 1.842.36 2.502.252.66.594 1.152 1.026 1.476.444.312.948.468 1.512.468ZM407.124 791v-11.7l1.026 1.062h-3.69V778.4h5.004V791h-2.34Zm9.016.18a9.155 9.155 0 0 1-2.61-.378c-.84-.264-1.548-.624-2.124-1.08l.99-1.818c.456.372 1.008.672 1.656.9a6.24 6.24 0 0 0 2.052.342c.828 0 1.476-.174 1.944-.522.48-.348.72-.816.72-1.404 0-.396-.102-.744-.306-1.044-.192-.3-.54-.528-1.044-.684-.492-.156-1.17-.234-2.034-.234h-3.042l.648-6.858h7.398v1.962h-6.534l1.224-1.116-.486 5.13-1.224-1.098h2.538c1.248 0 2.25.168 3.006.504.768.324 1.326.78 1.674 1.368.36.576.54 1.236.54 1.98 0 .732-.18 1.404-.54 2.016-.36.612-.912 1.104-1.656 1.476-.732.372-1.662.558-2.79.558Z"
                            fill="currentColor"
                        ></path>
                    </svg>
                </div>
                <div className={styles.measurements__preview}>
                    {!selectedOrOnlyRecommended || withoutSole ? null : (
                        <div
                            className={cn(styles.measurements__preview__shoeSole, {
                                [styles.fit]: selectedOrOnlyRecommended.isFit,
                            })}
                            style={
                                {
                                    '--length': selectedOrOnlyRecommended.size.length?.toString() ?? null,
                                    '--width': selectedOrOnlyRecommended.size.width?.toString() ?? null,
                                } as React.CSSProperties
                            }
                        >
                            <svg
                                preserveAspectRatio="none"
                                width="100%"
                                height="100%"
                                viewBox="0 0 244 690"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <mask
                                    id="a"
                                    style={{ maskType: 'alpha' }}
                                    maskUnits="userSpaceOnUse"
                                    x="0"
                                    y="0"
                                    width="244"
                                    height="690"
                                >
                                    {sku === 'EM24' ? (
                                        <path
                                            d="M219.626 37.13c25.106 38.01 25.433 95.704 23.822 139.002-1.215 32.637-6.028 53.356-17.395 83.25-3.486 9.17-7.602 17.682-11.477 26.652-15.064 34.864-27.75 69.607-28.242 108.101-.213 16.581 2.068 31.596 4.85 47.847 2.659 15.525 4.885 30.801 8.035 46.283 3.121 15.34 6.142 30.226 9.751 45.48 7.408 31.319 13.947 64.497 8.396 96.501-2.876 16.58-12.234 35.223-25.377 46.092-12.955 10.712-27.381 13.428-43.772 13.653-60.339.824-76.834-53.248-81.692-103.039-3.732-31.958-6.849-62.987-10.834-95.07-3.399-27.358-12.618-63.845-19.69-90.874C19.639 338.46-2.541 283.374.239 217.274c1.58-37.578 11.78-76.943 27.712-110.999C41.62 77.051 62.8 43.172 88.633 23.118c10.11-7.848 27.963-17.65 40.364-20.757 33.42-8.375 71.675 6.073 90.629 34.769Z"
                                            fill="currentColor"
                                        />
                                    ) : (
                                        <path
                                            d="M170.934 5.963c17.267 7.33 28.635 19.367 36.908 34.338 19.171 34.693 32.556 91.817 35.623 131.39 1.907 33.502-1.217 67.986-10.504 100.564-17.651 61.921-36.231 90.341-35.065 157.068.281 16.114 2.426 30.782 4.266 46.693 3.46 29.921 10.198 60.817 16.115 90.489 6.421 32.206 10.88 68.921-12.457 96.936-21.653 25.994-65.21 33.675-97.42 19.629-34.593-15.599-46.418-45.098-51.388-77.175-5.651-45.207-6.318-93.5-12.867-140.02-5.984-42.492-22.141-91.209-32.676-132.501C5.415 309.643-.023 265.429 0 241.136.063 175.477 30.585 86.349 75.891 34.747c10.577-12.046 23.43-24.814 39.872-30.47 17.96-6.178 37.767-5.703 55.171 1.686Z"
                                            fill="currentColor"
                                        />
                                    )}
                                </mask>
                                <g mask="url(#a)" fill="currentColor" fillOpacity=".4">
                                    <rect height="690" width="244"></rect>
                                    <path
                                        opacity=".25"
                                        d="M-39.531 197v-88h10.875v24.475L-19.915 109h10.876l-10.876 33.825L-9.039 197h-10.876l-7.158-35.475-1.583 5.087V197h-10.875ZM-6.492 197v-76.725c0-3.117.848-5.752 2.546-7.906S.528 109.092 4.383 109h8.741c3.855.092 6.631 1.215 8.329 3.369 1.698 2.154 2.547 4.789 2.547 7.906V197H13.124v-42.969l-8.741 3.438V197H-6.492Zm10.875-50.806 8.741-3.369v-22.55H4.383v25.919ZM46 598v-88h19.617c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906v10.656H65.617v-10.656h-8.742v66.137h8.742v-11.343h10.875v11.343c0 4.125-.344 6.921-1.032 8.388-.643 1.467-1.767 2.2-3.373 2.2H46ZM79.039 521.275V510h28.083v11.275h-9.017V598H87.23v-76.725h-8.191ZM109.6 598v-76.725c0-3.117.849-5.752 2.546-7.906 1.698-2.154 4.474-3.277 8.329-3.369h19.617v11.275h-19.617v25.919l16.106-6.188 3.511 9.832-19.617 7.631v28.943h19.617V598H109.6ZM142.638 598v-10.588h1.584c.55 0 .963-.206 1.238-.618.322-.413.528-1.329.62-2.75l2.203-62.769c0-3.117.848-5.752 2.546-7.906s4.474-3.277 8.329-3.369h16.795v88h-10.876v-76.725h-5.919l-2.409 66.137c-.184 4.125-.62 6.921-1.308 8.388-.642 1.467-1.652 2.2-3.029 2.2h-9.774ZM178.43 598v-88h10.876v42.35l15.074 5.775c2.34 1.421 3.671 3.667 3.992 6.737a76.43 76.43 0 0 1 .55 9.213v12.65c0 3.117-.848 5.752-2.546 7.906s-4.474 3.277-8.329 3.369H178.43Zm10.876-10.588h8.741v-20.418l-8.741-3.369v23.787ZM211.469 598v-88h10.875v24.475L231.086 510h10.875l-10.875 33.825L241.961 598h-10.875l-7.158-35.475-1.584 5.087V598h-10.875ZM244.508 598v-76.725c0-3.117.849-5.752 2.547-7.906 1.698-2.154 4.474-3.277 8.328-3.369h8.742c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906V598h-10.875v-42.969l-8.742 3.438V598h-10.875Zm10.875-50.806 8.742-3.369v-22.55h-8.742v25.919ZM-26 698v-88h19.617c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906v10.656H-6.383v-10.656h-8.742v66.137h8.742v-11.343H4.492v11.343c0 4.125-.344 6.921-1.032 8.388-.643 1.467-1.767 2.2-3.373 2.2H-26ZM7.039 621.275V610h28.083v11.275h-9.017V698H15.23v-76.725H7.039ZM37.6 698v-76.725c0-3.117.849-5.752 2.546-7.906 1.698-2.154 4.474-3.277 8.329-3.369h19.617v11.275H48.475v25.919l16.106-6.188 3.51 9.832-19.616 7.631v28.943h19.617V698H37.6ZM70.638 698v-10.588h1.584c.55 0 .963-.206 1.239-.618.32-.413.527-1.329.619-2.75l2.203-62.769c0-3.117.849-5.752 2.546-7.906 1.698-2.154 4.474-3.277 8.329-3.369h16.795v88H93.077v-76.725h-5.92l-2.408 66.137c-.184 4.125-.62 6.921-1.308 8.388-.642 1.467-1.652 2.2-3.029 2.2h-9.774ZM106.43 698v-88h10.876v42.35l15.074 5.775c2.34 1.421 3.671 3.667 3.992 6.737a76.43 76.43 0 0 1 .55 9.213v12.65c0 3.117-.848 5.752-2.546 7.906s-4.474 3.277-8.329 3.369H106.43Zm10.876-10.588h8.741v-20.418l-8.741-3.369v23.787ZM139.469 698v-88h10.875v24.475L159.086 610h10.875l-10.875 33.825L169.961 698h-10.875l-7.158-35.475-1.584 5.087V698h-10.875ZM172.508 698v-76.725c0-3.117.849-5.752 2.547-7.906 1.698-2.154 4.474-3.277 8.328-3.369h8.742c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906V698h-10.875v-42.969l-8.742 3.438V698h-10.875Zm10.875-50.806 8.742-3.369v-22.55h-8.742v25.919ZM114 498v-88h19.617c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906v10.656h-10.875v-10.656h-8.742v66.138h8.742v-11.344h10.875v11.344c0 4.125-.344 6.92-1.032 8.387-.643 1.467-1.767 2.2-3.373 2.2H114ZM147.039 421.275V410h28.083v11.275h-9.017V498H155.23v-76.725h-8.191ZM177.6 498v-76.725c0-3.117.849-5.752 2.546-7.906 1.698-2.154 4.474-3.277 8.329-3.369h19.617v11.275h-19.617v25.919l16.106-6.188 3.511 9.831-19.617 7.632v28.944h19.617V498H177.6ZM210.638 498v-10.587h1.584c.55 0 .963-.207 1.238-.619.322-.413.528-1.329.62-2.75l2.203-62.769c0-3.117.848-5.752 2.546-7.906s4.474-3.277 8.329-3.369h16.795v88h-10.876v-76.725h-5.919l-2.409 66.138c-.184 4.125-.62 6.92-1.308 8.387-.642 1.467-1.652 2.2-3.029 2.2h-9.774ZM246.43 498v-88h10.876v42.35l15.074 5.775c2.34 1.421 3.671 3.667 3.992 6.737a76.43 76.43 0 0 1 .55 9.213v12.65c0 3.117-.848 5.752-2.546 7.906s-4.474 3.277-8.329 3.369H246.43Zm10.876-10.587h8.741v-20.419l-8.741-3.369v23.788ZM-12.57 498v-88h10.876v42.35l15.074 5.775c2.34 1.421 3.67 3.667 3.992 6.737a76.41 76.41 0 0 1 .55 9.213v12.65c0 3.117-.848 5.752-2.546 7.906s-4.474 3.277-8.329 3.369H-12.57Zm10.876-10.587h8.741v-20.419l-8.741-3.369v23.788ZM20.47 498v-88h10.875v24.475L40.085 410h10.875l-10.875 33.825L50.961 498H40.086l-7.158-35.475-1.583 5.087V498H20.468ZM53.508 498v-76.725c0-3.117.849-5.752 2.547-7.906 1.697-2.154 4.474-3.277 8.328-3.369h8.742c3.854.092 6.63 1.215 8.328 3.369 1.698 2.154 2.547 4.789 2.547 7.906V498H73.125v-42.969l-8.742 3.438V498H53.508Zm10.875-50.806 8.742-3.369v-22.55h-8.742v25.919ZM-33 398.369v-88.842h19.781c3.887.092 6.687 1.226 8.399 3.401 1.712 2.175 2.568 4.835 2.568 7.982v10.758H-13.22V320.91h-8.815v66.77h8.815v-11.452h10.967v11.452c0 4.165-.347 6.987-1.041 8.468-.648 1.481-1.782 2.221-3.401 2.221H-33ZM.316 320.91v-11.383h28.318v11.383h-9.092v77.459H8.575V320.91H.315ZM31.133 398.369V320.91c0-3.147.856-5.807 2.568-7.982 1.712-2.175 4.512-3.309 8.398-3.401h19.782v11.383H42.099v26.167l16.242-6.247 3.54 9.925-19.782 7.704v29.221h19.782v10.689H31.133ZM64.449 398.369V387.68h1.596c.555 0 .972-.208 1.25-.624.323-.417.532-1.342.624-2.777l2.221-63.369c0-3.147.856-5.807 2.568-7.982 1.713-2.175 4.512-3.309 8.399-3.401h16.935v88.842H87.076V320.91h-5.97l-2.428 66.77c-.186 4.165-.625 6.987-1.32 8.468-.647 1.481-1.665 2.221-3.053 2.221h-9.856ZM100.541 398.369v-88.842h10.967v42.755l15.2 5.83c2.36 1.435 3.702 3.702 4.026 6.802.37 3.054.555 6.155.555 9.301v12.771c0 3.147-.856 5.807-2.568 7.982-1.712 2.175-4.512 3.309-8.399 3.401h-19.781Zm10.967-10.689h8.814v-20.614l-8.814-3.401v24.015ZM133.857 398.369v-88.842h10.966v24.709l8.815-24.709h10.967l-10.967 34.149 10.967 54.693h-10.967l-7.218-35.814-1.597 5.136v30.678h-10.966ZM167.173 398.369V320.91c0-3.147.856-5.807 2.568-7.982 1.712-2.175 4.511-3.309 8.398-3.401h8.815c3.887.092 6.686 1.226 8.398 3.401 1.712 2.175 2.568 4.835 2.568 7.982v77.459h-10.966v-43.38l-8.815 3.47v39.91h-10.966Zm10.966-51.292 8.815-3.401V320.91h-8.815v26.167ZM12 297.527v-88.842h19.782c3.887.092 6.686 1.226 8.398 3.401 1.712 2.174 2.568 4.835 2.568 7.981v10.759H31.782v-10.759h-8.815v66.771h8.815v-11.452h10.966v11.452c0 4.164-.347 6.987-1.04 8.468-.649 1.48-1.782 2.221-3.402 2.221H12.001ZM45.316 220.067v-11.382h28.319v11.382h-9.093v77.46H53.576v-77.46h-8.26ZM76.133 297.527v-77.46c0-3.146.857-5.807 2.569-7.981 1.712-2.175 4.511-3.309 8.398-3.401h19.781v11.382H87.1v26.167l16.241-6.246 3.54 9.925-19.781 7.704v29.221h19.781v10.689H76.133ZM109.449 297.527v-10.689h1.597c.555 0 .971-.208 1.249-.625.324-.416.532-1.342.625-2.776l2.221-63.37c0-3.146.856-5.807 2.568-7.981 1.712-2.175 4.511-3.309 8.398-3.401h16.936v88.842h-10.967v-77.46h-5.969l-2.429 66.771c-.185 4.164-.625 6.987-1.319 8.468-.648 1.48-1.666 2.221-3.054 2.221h-9.856ZM145.541 297.527v-88.842h10.967v42.755l15.2 5.83c2.36 1.435 3.702 3.702 4.026 6.802.37 3.054.555 6.154.555 9.301v12.771c0 3.146-.856 5.807-2.568 7.982-1.712 2.175-4.511 3.308-8.398 3.401h-19.782Zm10.967-10.689h8.815v-20.614l-8.815-3.401v24.015ZM178.857 297.527v-88.842h10.967v24.709l8.815-24.709h10.966l-10.966 34.148 10.966 54.694h-10.966l-7.219-35.815-1.596 5.136v30.679h-10.967ZM212.173 297.527v-77.46c0-3.146.856-5.807 2.568-7.981 1.712-2.175 4.512-3.309 8.399-3.401h8.814c3.887.092 6.687 1.226 8.399 3.401 1.712 2.174 2.568 4.835 2.568 7.981v77.46h-10.967v-43.38l-8.814 3.47v39.91h-10.967Zm10.967-51.293 8.814-3.401v-22.766h-8.814v26.167ZM54 196.685v-88.843h19.781c3.887.093 6.687 1.226 8.399 3.401 1.712 2.175 2.568 4.836 2.568 7.982v10.758H73.78v-10.758h-8.815v66.771h8.815v-11.453h10.967v11.453c0 4.164-.347 6.987-1.041 8.467-.648 1.481-1.782 2.222-3.401 2.222H54ZM87.316 119.225v-11.383h28.318v11.383h-9.092v77.46H95.575v-77.46h-8.26ZM118.133 196.685v-77.46c0-3.146.856-5.807 2.568-7.982 1.712-2.175 4.512-3.308 8.398-3.401h19.782v11.383h-19.782v26.167l16.242-6.247 3.54 9.926-19.782 7.704v29.221h19.782v10.689h-30.748ZM151.449 196.685v-10.689h1.596c.556 0 .972-.209 1.25-.625.324-.416.532-1.342.624-2.776l2.221-63.37c0-3.146.856-5.807 2.568-7.982 1.712-2.175 4.512-3.308 8.399-3.401h16.935v88.843h-10.966v-77.46h-5.969l-2.429 66.771c-.186 4.164-.625 6.987-1.319 8.467-.648 1.481-1.666 2.222-3.054 2.222h-9.856ZM187.541 196.685v-88.843h10.967v42.756l15.2 5.83c2.36 1.434 3.702 3.702 4.026 6.802.37 3.054.555 6.154.555 9.301v12.771c0 3.146-.856 5.807-2.568 7.982-1.712 2.174-4.512 3.308-8.399 3.401h-19.781Zm10.967-10.689h8.814v-20.614l-8.814-3.401v24.015ZM220.857 196.685v-88.843h10.966v24.71l8.815-24.71h10.967l-10.967 34.149 10.967 54.694h-10.967l-7.218-35.815-1.597 5.136v30.679h-10.966ZM254.173 196.685v-77.46c0-3.146.856-5.807 2.568-7.982 1.712-2.175 4.511-3.308 8.398-3.401h8.815c3.887.093 6.686 1.226 8.398 3.401 1.712 2.175 2.568 4.836 2.568 7.982v77.46h-10.966v-43.38l-8.815 3.47v39.91h-10.966Zm10.966-51.293 8.815-3.401v-22.766h-8.815v26.167ZM-22 95.842V7h19.782c3.887.093 6.686 1.226 8.398 3.401 1.712 2.175 2.568 4.835 2.568 7.982V29.14H-2.218V18.383h-8.815v66.77h8.815V73.701H8.748v11.452c0 4.165-.347 6.987-1.04 8.468-.649 1.48-1.782 2.221-3.402 2.221H-22ZM11.316 18.383V7h28.319v11.383h-9.093v77.46H19.576v-77.46h-8.26ZM42.133 95.842v-77.46c0-3.146.856-5.806 2.569-7.981C46.414 8.226 49.213 7.093 53.1 7H72.88v11.383H53.1V44.55l16.241-6.247 3.54 9.925L53.1 55.933v29.22H72.88v10.69H42.133ZM75.45 95.842V85.153h1.596c.555 0 .971-.208 1.25-.624.323-.417.531-1.342.624-2.777l2.22-63.37c0-3.146.857-5.806 2.569-7.981S88.22 7.093 92.107 7h16.936v88.842H98.076v-77.46h-5.969l-2.429 66.771c-.185 4.165-.625 6.987-1.319 8.468-.648 1.48-1.666 2.221-3.054 2.221H75.45ZM111.541 95.842V7h10.967v42.755l15.2 5.83c2.36 1.435 3.702 3.702 4.026 6.803.37 3.054.555 6.154.555 9.3V84.46c0 3.147-.856 5.807-2.568 7.982-1.712 2.175-4.511 3.309-8.398 3.401h-19.782Zm10.967-10.689h8.815V64.54l-8.815-3.4v24.014ZM144.857 95.842V7h10.967v24.71L164.639 7h10.966l-10.966 34.149 10.966 54.693h-10.966l-7.219-35.814-1.596 5.136v30.678h-10.967ZM178.173 95.842v-77.46c0-3.146.856-5.806 2.568-7.981 1.712-2.175 4.512-3.308 8.399-3.401h8.814c3.887.093 6.687 1.226 8.399 3.401 1.712 2.175 2.568 4.835 2.568 7.982v77.46h-10.967v-43.38l-8.814 3.47v39.91h-10.967ZM189.14 44.55l8.814-3.401V18.383h-8.814V44.55Z"
                                    />
                                </g>
                            </svg>
                        </div>
                    )}
                    <div
                        className={styles.measurements__preview__foot}
                        style={
                            {
                                '--length': store.length?.toString() ?? null,
                                '--width': store.width?.toString() ?? null,
                            } as React.CSSProperties
                        }
                    >
                        {!store.length ? null : (
                            <div className={cn(styles.measurement__tooltip, styles.yTooltip)}>
                                <span>{toCm(store.length)?.toFixed(1)}</span>
                                <svg
                                    className={styles.measurement__tooltip__arrow}
                                    focusable="false"
                                    aria-hidden="true"
                                    width="12"
                                    height="6"
                                    viewBox="0 0 12 16"
                                >
                                    <path stroke="none" d="M0,0 H12 L6,6 Q6,6 6,6 Z"></path>
                                </svg>
                            </div>
                        )}
                        {!store.width ? null : (
                            <div className={cn(styles.measurement__tooltip, styles.xTooltip)}>
                                <span>{toCm(store.width)?.toFixed(1)}</span>
                                <svg
                                    className={styles.measurement__tooltip__arrow}
                                    focusable="false"
                                    aria-hidden="true"
                                    width="12"
                                    height="6"
                                    viewBox="0 0 12 16"
                                >
                                    <path stroke="none" d="M0,0 H12 L6,6 Q6,6 6,6 Z"></path>
                                </svg>
                            </div>
                        )}
                        <svg
                            preserveAspectRatio="none"
                            width="100%"
                            height="100%"
                            focusable="false"
                            viewBox="0 0 197 590"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <path
                                d="M131.595 113.106c-2.767-5.202-5.533-10.403-8.082-15.418-.548.279-1.123.349-1.481.605l1.725 14.269c11.522 6.912 22.146 19.256 38.492 13.025l.329 2.728c-2.605.953-5.491 2.792-7.866 2.44-6.981-1.5-14.347-2.953-20.574-6.246-10.387-5.56-20.864-10.256-32.174-10.594-4.481-.098-9.818.759-12.987 3.484-13.197 11.387-25.934 23.356-38.021 35.886-8.306 8.455-15.042 18.636-22.888 27.674-1.712 1.91-6.04 3.071-7.917 2.019-3.776-2.312-1.693-5.97.493-8.788 5.891-7.525 12-14.862 17.483-22.55 1.163-1.63 1.931-4.917 1.32-6.759-2.344-6.53-5.07-13.014-8.487-18.776-1.912-2.963-5.548-5.718-8.93-6.374-4.8-1.123-8.3 2.067-10.207 7.193-4.799 13.354-3.29 27.437-2.192 41.356.29 4.011.989 8.184 1.496 12.381-.549.279-1.315.372-1.864.651-1.248-3.895-2.662-7.556-3.527-11.497-3.053-12.406-4.166-24.833-1.782-37.257 2.205-10.699 6.004-19.46 18.438-19.471.103-16.832.666-33.08 21.502-34.318.359-17.927 3.92-33.473 23.43-36.042C68.7 30 71.55 26.25 81.738 23.742c16.408-4.11 17.033-3.76 23.013 5.525 2.023-5.78 3.191-13.798 7.255-18.76 4.421-5.217 11.509-9.266 18.021-10.053 14.121-2.13 26.615 3.175 35.093 17.056 5.813 9.517 10.937 19.757 16.559 29.298 8.797 14.907 7.06 31.266 6.906 47.678-.305 32.438 19.083 79.704 0 125.624-17.712 42.622-39.32 85.071-36.019 131.224 4.585 62.438 62.452 199.452-3.199 231.252-35.006 16.956-60.7 2.919-74.857-22.805-15.82-28.743-18.395-71.019-27.625-124.822C29.66 334.545 11.246 282.135.038 234.926c-.47-2.285 3.555-.886 4.404 2.001 12.81 43.608 36.027 116.021 48.448 188.43 9.266 54.014 12.826 99.804 28.426 128.823 12.64 23.514 35.515 37.835 65.506 21.204 62.048-34.406.704-164.722-3.462-224.05-2.827-39.472 14.38-77.292 35.887-124.685 28.022-61.749-.8-101.062 3.111-150.116.149-10.025-2.474-18.863-7.178-27.238-5.188-9.167-10.21-18.567-15.565-27.501C149.532 4.275 128.33.873 115.961 14.288c-1.713 1.91-3.489 4.892-3.734 7.69-.571 11.353-.568 22.636-.73 34.153-.267 13.872 4.485 25.86 11.867 37.104 2.856 4.34 5.188 9.167 7.329 14.019.969 1.585.673 3.963.902 5.852Zm-43.196-6.921c9.804.732 19.608 1.465 29.387 1.988.791-14.36.407-14.314-5.57-26.793-2.842-5.83-5.428-12.758-5.423-19.145-.029-11.494-4.31-21.196-9-31.063-.777-1.61-3.354-3.64-4.861-3.245-4.979.6-10.1 1.644-14.71 3.69-5.351 2.35-6.237 9.483-2.706 14.592C86.521 61.7 93.414 78.54 88.661 98.701c-.487 2.401-.158 5.129-.262 7.484-.47-2.286-1.375-4.945-1.679-7.463-.468-5.478.572-11.352-1.02-16.483-2.673-9.258-7.045-18.1-10.46-27.054-2.266-5.9-6.057-6.72-10.96-5.49-8.11 2.043-12.263 7.866-13.904 16.793-1.526 8.275-2.337 16.038 6.774 20.687 2.068 1.028 3.687 3.174 5.614 4.645 4.988 4.295 6.388 9.448 4.275 16.09-1.548 4.871-2.28 10.07-3.42 15.103.433.374.867.748 1.468.888 7.817-6.053 15.66-11.896 23.312-17.716Zm-46.208 40.494c4.139-4.332 7.296-8.758 11.447-11.389 6.489-4.19 7.528-10.063 8.964-17.475 2.642-13.52-.747-22.265-12.053-28.991-6.903-4.064-13.783-4.724-18.346.937-4.396 5.427-5.75 21.559-2.652 26.294 3.341 5.133 6.183 10.964 8.616 16.632 1.848 4.034 2.598 8.628 4.024 13.992Z"
                                fill="currentColor"
                            ></path>
                        </svg>
                    </div>
                </div>
            </div>
            {withoutSole ? null : (
                <>
                    <div className={styles.recommendedSize}>
                        {t("fitting.Ваш рекомендованный размер")}: <span>{store.recommended ?? '-'}</span>
                    </div>
                    {isWarning ? <div className={styles.warning}>{warning}</div> : null}
                </>
            )}
        </div>
    );
}

const useMobileMediaQuery = () => {
    const mediaQuery = window.matchMedia('screen and (max-width: 1023px)');
    const [match, setMatch] = useState(mediaQuery.matches);

    useEffect(() => {
        const onChange = () => setMatch(mediaQuery.matches);
        mediaQuery.addEventListener('change', onChange);
        return () => mediaQuery.removeEventListener('change', onChange);
    }, [mediaQuery]);

    return match;
};

const getVisible = ({ showOn, isMobile }: Pick<Props, 'showOn'> & { isMobile: boolean }) => {
    switch (showOn) {
        case 'mobile':
            return isMobile;
        case 'desktop':
            return !isMobile;
        default:
            return true;
    }
};

function toCm(valueInMm: number | undefined) {
    if (!valueInMm) return undefined;
    return valueInMm / 10;
}

export default MeasurementsIllustration;
